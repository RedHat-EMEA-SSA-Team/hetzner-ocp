---
- name: Create in-memory inventory
  gather_facts: no
  hosts: localhost
  vars_files:
  - ../vars/guests.yml
  roles:
  - ../roles/inmemory_inventory
  
- name: Fix resolv.conf to work with services
  hosts: nodes
  gather_facts: false
  tasks:
  - name: Fix resolv.conf
    lineinfile:
      dest: /etc/resolv.conf
      state: present
      insertafter: '# Generated by NetworkManager'
      line: 'search cluster.local'
